<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="/static/css/slick.grid.css" type="text/css"/>
<link rel="stylesheet" href="/static/css/smoothness/jquery-ui-1.8.16.custom.css" type="text/css"/>
<link rel="stylesheet" href="/static/css/examples.css" type="text/css"/>
<title>코드 관리</title>
</head>
<script src="/static/js/slick/lib/jquery-1.7.min.js"></script>
<script src="/static/js/slick/lib/jquery.event.drag-2.2.js"></script>
<script src="/static/js/slick/slick.core.js"></script>
<script src="/static/js/slick/slick.grid.js"></script>
<script src="/static/js/jquery-3.4.1.min.js"></script>
<script src="/static/js/common.js"></script>
<script type="text/javascript">

	var grid;
	var column1 = [
	    {id: "codeGrp", name: "코드그룹", field: "codeGrp", width: 180},
	    {id: "codeGrpNm", name: "코드그룹명", field: "codeGrpNm", width: 180},
	    {id: "codeGrpDesc", name: "설명", field: "codeGrpDesc", width: 480},
	    {id: "useYn", name: "사용여부", field: "useYn", width: 100}
	  ];

	  var option1 = {
	    enableCellNavigation: true,
	    enableColumnReorder: false
	  };
	
	
	var grid2;
	var column2 = [
	    {id: "codeGroupCd", name: "코드그룹", field: "codeGroupCd", width: 180},
	    {id: "code", name: "코드", field: "code", width: 180},
	    {id: "codeNm", name: "코드명", field: "codeNm", width: 200},
	    {id: "codeDesc", name: "코드명", field: "codeDesc", width: 480},
	    {id: "useYn", name: "사용여부", field: "useYn", width: 100}
	  ];

	  var option2 = {
	    enableCellNavigation: true,
	    enableColumnReorder: false
	  };
	
	$(document).ready(function() {
		$("#searchBtn").click(function(e) {
			var params = fnGetParams();

		    ajaxJsonCall('/sys/codeGrpList',  params, fnSuccess);
	    });
		
		grid = new Slick.Grid("#grid1", [], column1, option1);
		grid2 = new Slick.Grid("#grid2", [], column2, option2);
		
	});
	
	function fnSuccess(data){
		
		setGrid1(data);
		
	}
	
    function setGrid1(datas){
	    grid = new Slick.Grid("#grid1", datas, column1, option1);
	    
	    grid.onClick.subscribe(function (e) {
	        var cell = grid.getCellFromEvent(e);
	        if(grid.getColumns()[cell.cell].id == "codeGrp") {
			  
	        	searchCodeDetail(datas[cell.row].codeGrp);
	        	
	        }
	      });
	}
	
    function searchCodeDetail(codeGrp){
    	
    	var params = new Object();
    	
    	params.codeGrp = codeGrp;

	    ajaxJsonCall('/sys/codeDetailList',  params, fnSuccess2);
    	
    }
    
	function fnSuccess2(data){
		
		setGrid2(data);
		
	}
	
	function setGrid2(datas){
		grid2 = new Slick.Grid("#grid2", datas, column2, option2);
	}
</script>

<body>
<p style="font-size: 18px;font-weight: bold;">공통코드 관리</p>
<table style="width: 100%;border: 1px solid">
	<tr>
		<th>그룹코드</th>
		<td><input type="text" id="codeGrp" name="codeGroup" value="" ></td>
		<th>그룹코드명</th>
		<td><input type="text" id="codeGrpNm" name="codeGroupNm" value="" ></td>
		<td><button type="button" id="searchBtn">조회</button></td>
	</tr>
</table>
<br>
<div style="position: relative;display: inline-block;width: 100%;">
<div style="float: left;"><p style="font-size: 15px">그룹코드</p></div>
<div style="float: right;padding-top: 15px"><button type="button" id="">저장</button>&nbsp;</div>
<div style="float: right;padding-top: 15px"><button type="button" id="">삭제</button>&nbsp;</div>
<div style="float: right;padding-top: 15px"><button type="button" id="">그룹추가</button>&nbsp;</div>
</div>
<br>
<div id="codeGroupList" style="width: 100%;height:400px;border: 1px solid;position: relative;">
	<div id="grid1" style="width:100%;height:100%;"></div>
</div>
<div style="position: relative;display: inline-block;width: 100%;">
<div style="float: left;"><p style="font-size: 15px">상세코드</p></div>
<div style="float: right;padding-top: 15px"><button type="button" id="">저장</button>&nbsp;</div>
<div style="float: right;padding-top: 15px"><button type="button" id="">삭제</button>&nbsp;</div>
<div style="float: right;padding-top: 15px"><button type="button" id="">상세추가</button>&nbsp;</div>
</div>
<div id="codeDetailList" style="width: 100%;height:300px;border: 1px solid">
	<div id="grid2" style="width:100%;height:100%;"></div>
</div>
</body>
</html>